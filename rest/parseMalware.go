package rest

import (
	"encoding/json"
	"fmt"
	"github.com/aquasecurity/reportgen/data"
	"os"
)

func getMalwares(user, password, url string) *data.MalwareType {
	malware := new(data.MalwareType)
	data := getData(url, user, password)
	if err := json.Unmarshal(data, malware); err != nil {
		fmt.Println("Can't parse response from server (malware):", string(data))
		os.Exit(1)
	}
	return malware
}
